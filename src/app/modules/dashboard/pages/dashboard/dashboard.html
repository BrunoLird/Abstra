<div class="dashboard-container">
  <!-- Sidebar -->
  <aside class="sidebar">
    <div class="sidebar-header">
      <div class="logo">
        <img
          ngSrc="./assets/icons/certificate-icon.png"
          alt="User Certificate"
          class="logo-certificate"
          height="512" width="512" />
        <span class="logo-text">Certifin</span>
      </div>
    </div>

    <nav class="sidebar-nav">
      <button
        class="nav-item"
        [class.active]="activeMenu() === 'dashboard'"
        (click)="setActiveMenu('dashboard')"
      >
        <svg width="20" height="20" viewBox="0 0 20 20" fill="currentColor">
          <path d="M3 4a1 1 0 011-1h12a1 1 0 011 1v2a1 1 0 01-1 1H4a1 1 0 01-1-1V4zM3 10a1 1 0 011-1h6a1 1 0 011 1v6a1 1 0 01-1 1H4a1 1 0 01-1-1v-6zM14 9a1 1 0 00-1 1v6a1 1 0 001 1h2a1 1 0 001-1v-6a1 1 0 00-1-1h-2z"/>
        </svg>
        Dashboard
      </button>

      <button
        class="nav-item"
        [class.active]="activeMenu() === 'course'"
        (click)="setActiveMenu('course')"
      >
        <svg width="20" height="20" viewBox="0 0 20 20" fill="currentColor">
          <path d="M9 4.804A7.968 7.968 0 005.5 4c-1.255 0-2.443.29-3.5.804v10A7.969 7.969 0 015.5 14c1.669 0 3.218.51 4.5 1.385A7.962 7.962 0 0114.5 14c1.255 0 2.443.29 3.5.804v-10A7.968 7.968 0 0014.5 4c-1.255 0-2.443.29-3.5.804V12a1 1 0 11-2 0V4.804z"/>
        </svg>
        Course
      </button>

      <button
        class="nav-item active"
        [class.active]="activeMenu() === 'certification'"
        (click)="setActiveMenu('certification')"
      >
        <svg width="20" height="20" viewBox="0 0 20 20" fill="currentColor">
          <path d="M9 2a2 2 0 00-2 2v8a2 2 0 002 2h6a2 2 0 002-2V6.414A2 2 0 0016.414 5L14 2.586A2 2 0 0012.586 2H9z"/>
          <path d="M3 8a2 2 0 012-2v10h8a2 2 0 01-2 2H5a2 2 0 01-2-2V8z"/>
        </svg>
        Certification
      </button>

      <button
        class="nav-item"
        [class.active]="activeMenu() === 'discussions'"
        (click)="setActiveMenu('discussions')"
      >
        <svg width="20" height="20" viewBox="0 0 20 20" fill="currentColor">
          <path d="M2 5a2 2 0 012-2h7a2 2 0 012 2v4a2 2 0 01-2 2H9l-3 3v-3H4a2 2 0 01-2-2V5z"/>
          <path d="M15 7v2a4 4 0 01-4 4H9.828l-1.766 1.767c.28.149.599.233.938.233h2l3 3v-3h2a2 2 0 002-2V9a2 2 0 00-2-2h-1z"/>
        </svg>
        All Discissions
      </button>

      <button
        class="nav-item"
        [class.active]="activeMenu() === 'settings'"
        (click)="setActiveMenu('settings')"
      >
        <svg width="20" height="20" viewBox="0 0 20 20" fill="currentColor">
          <path fill-rule="evenodd" d="M11.49 3.17c-.38-1.56-2.6-1.56-2.98 0a1.532 1.532 0 01-2.286.948c-1.372-.836-2.942.734-2.106 2.106.54.886.061 2.042-.947 2.287-1.561.379-1.561 2.6 0 2.978a1.532 1.532 0 01.947 2.287c-.836 1.372.734 2.942 2.106 2.106a1.532 1.532 0 012.287.947c.379 1.561 2.6 1.561 2.978 0a1.533 1.533 0 012.287-.947c1.372.836 2.942-.734 2.106-2.106a1.533 1.533 0 01.947-2.287c1.561-.379 1.561-2.6 0-2.978a1.532 1.532 0 01-.947-2.287c.836-1.372-.734-2.942-2.106-2.106a1.532 1.532 0 01-2.287-.947zM10 13a3 3 0 100-6 3 3 0 000 6z" clip-rule="evenodd"/>
        </svg>
        Settings
      </button>
    </nav>
  </aside>

  <!-- Main Content -->
  <main class="main-content">
    <header class="header">
      <div class="search-bar">
        <svg class="search-icon" width="20" height="20" viewBox="0 0 20 20" fill="currentColor">
          <path fill-rule="evenodd" d="M8 4a4 4 0 100 8 4 4 0 000-8zM2 8a6 6 0 1110.89 3.476l4.817 4.817a1 1 0 01-1.414 1.414l-4.816-4.816A6 6 0 012 8z" clip-rule="evenodd"/>
        </svg>
        <form [formGroup]="searchForm">
          <input
            type="text"
            formControlName="query"
            placeholder="Search certificate"
            class="search-input"
          />
        </form>
      </div>

      <div class="header-actions">
        <button class="icon-btn" (click)="handleTranslate()">
          <svg width="20" height="20" viewBox="0 0 20 20" fill="currentColor">
            <path fill-rule="evenodd" d="M7 2a1 1 0 011 1v1h3a1 1 0 110 2H9.578a18.87 18.87 0 01-1.724 4.78c.29.354.596.696.914 1.026a1 1 0 11-1.44 1.389c-.188-.196-.373-.396-.554-.6a19.098 19.098 0 01-3.107 3.567 1 1 0 01-1.334-1.49 17.087 17.087 0 003.13-3.733 18.992 18.992 0 01-1.487-2.494 1 1 0 111.79-.89c.234.47.489.928.764 1.372.417-.934.752-1.913.997-2.927H3a1 1 0 110-2h3V3a1 1 0 011-1zm6 6a1 1 0 01.894.553l2.991 5.982a.869.869 0 01.02.037l.99 1.98a1 1 0 11-1.79.895L15.383 16h-4.764l-.724 1.447a1 1 0 11-1.788-.894l.99-1.98.019-.038 2.99-5.982A1 1 0 0113 8zm-1.382 6h2.764L13 11.236 11.618 14z" clip-rule="evenodd"/>
          </svg>
        </button>

        <button class="icon-btn" (click)="handleNotifications()">
          <svg width="20" height="20" viewBox="0 0 20 20" fill="currentColor">
            <path d="M10 2a6 6 0 00-6 6v3.586l-.707.707A1 1 0 004 14h12a1 1 0 00.707-1.707L16 11.586V8a6 6 0 00-6-6zM10 18a3 3 0 01-3-3h6a3 3 0 01-3 3z"/>
          </svg>
        </button>

        <div class="user-menu">
          <img
            ngSrc="./assets/images/profile-picture.png"
            alt="User avatar"
            class="user-avatar"
            height="42" width="42" />
          <div class="user-info">
            <span class="user-name">{{ user()?.name || 'Jhon Doe' }}</span>
            <span class="user-email">{{ user()?.email || 'jhondoe@gmail.com' }}</span>
          </div>
        </div>
      </div>
    </header>

    <!-- Certificates -->
    <section class="certificates-section">
      <div class="section-header">
        <div>
          <h1 class="section-title">Certificate of Completion</h1>
          <p class="section-description">Certifies successful completion of the course or program.</p>
        </div>
        <div class="section-actions">
          <button class="icon-btn-large">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"/>
            </svg>
          </button>
          <button class="icon-btn-large" (click)="handleMoreOptions()">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
              <path d="M12 6a2 2 0 110-4 2 2 0 010 4zm0 7a2 2 0 110-4 2 2 0 010 4zm0 7a2 2 0 110-4 2 2 0 010 4z"/>
            </svg>
          </button>
        </div>
      </div>

      @if (isLoading()) {
        <div class="loading-state">
          <div class="spinner-large"></div>
          <p>Loading certificates...</p>
        </div>
      } @else {
        <div class="certificates-grid">
          @for (cert of certificates(); track cert.id) {
            <div class="certificate-card" (click)="openCertificateModal(cert)">
              <div class="certificate-image">
                <img [src]="cert.imageUrl" [alt]="cert.title" />
              </div>
              <div class="certificate-content">
                <span class="certificate-date">{{ cert.date }}</span>
                <h3 class="certificate-title">{{ cert.title }}</h3>
                <p class="certificate-subtitle">{{ cert.subtitle }}</p>
                <button
                  class="favorite-btn"
                  [class.active]="cert.isFavorite"
                  (click)="toggleFavorite(cert.id); $event.stopPropagation()"
                >
                  <svg width="20" height="20" viewBox="0 0 22 22" [attr.fill]="cert.isFavorite ? 'currentColor' : 'none'" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"/>
                  </svg>
                </button>
              </div>
            </div>
          }
        </div>

        @if (certificates().length === 0) {
          <div class="empty-state">
            <svg width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/>
            </svg>
            <p>No certificates found</p>
          </div>
        }
      }
    </section>
  </main>
  @if (isModalOpen()) {
    <div class="modal-overlay" (click)="closeModal()">
      <div class="modal-content" (click)="$event.stopPropagation()">
        <button class="modal-close" (click)="closeModal()" aria-label="Close modal">
          <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
          </svg>
        </button>

        @if (selectedCertificate(); as cert) {
          <div class="modal-body">
            <div class="modal-image">
              <img [src]="cert.imageUrl" [alt]="cert.title" />
            </div>

            <div class="modal-info">
              <h2 class="modal-title">{{ cert.title }}</h2>
              <p class="modal-date">Completed on {{ cert.date }}</p>

              <div class="modal-description">
                <p>
                  Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed do eiusmod tempor incididunt ut labore et dolore magna aliqua.
                  Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat.
                </p>
                <p>
                  Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur.
                  Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.
                </p>
              </div>

              <button class="btn-download" (click)="downloadCertificate()">
                <svg width="20" height="20" viewBox="0 0 20 20" fill="currentColor">
                  <path fill-rule="evenodd" d="M3 17a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm3.293-7.707a1 1 0 011.414 0L9 10.586V3a1 1 0 112 0v7.586l1.293-1.293a1 1 0 111.414 1.414l-3 3a1 1 0 01-1.414 0l-3-3a1 1 0 010-1.414z" clip-rule="evenodd"/>
                </svg>
                Download Certificate
              </button>
            </div>
          </div>
        }
      </div>
    </div>
  }
</div>
